using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Xml;
using System.Drawing;
using CSKernelClient;

namespace CSReportDll
{
    public class cReportPageField
    {

        private const String C_MODULE = "cReportPageField";

        private String m_value = "";
        private cReportPageInfo m_info;
        private bool m_visible;
        private cReportPageID m_objectID;
        private int m_indexLine = 0;
        private float m_top = 0;
        private float m_height = 0;
        private float m_width = 0;
        private Image m_image = null;

        public String getValue()
        {
            return m_value;
        }

        public void setValue(String rhs)
        {
            m_value = rhs;
        }

        public cReportPageInfo getInfo()
        {
            return m_info;
        }

        public void setInfo(cReportPageInfo rhs)
        {
            m_info = rhs;
        }

        public bool getVisible()
        {
            return m_visible;
        }

        public void setVisible(bool rhs)
        {
            m_visible = rhs;
        }

        public cReportPageID getObjectID()
        {
            return m_objectID;
        }

        public void setObjectID(cReportPageID rhs)
        {
            m_objectID = rhs;
        }

        public float getTop()
        {
            return m_top;
        }

        public void setTop(float rhs)
        {
            m_top = rhs;
        }

        public float getHeight()
        {
            return m_height;
        }

        public void setHeight(float rhs)
        {
            m_height = rhs;
        }

        public float getWidth()
        {
            return m_width;
        }

        public void setWidth(float rhs)
        {
            m_width = rhs;
        }

        public Image getImage()
        {
            return m_image;
        }

        public void setImage(Image rhs)
        {
            m_image = rhs;
        }

        public int getIndexLine()
        {
            return m_indexLine;
        }

        public void setIndexLine(int rhs)
        {
            m_indexLine = rhs;
        }

        internal bool load(CSXml.cXml xDoc, XmlElement nodObj)
        {
            m_objectID = new cReportPageID();
            m_info = new cReportPageInfo();

            m_value = xDoc.getNodeProperty(nodObj, "Value").getValueString(eTypes.eText);
            m_visible = xDoc.getNodeProperty(nodObj, "Visible").getValueBool(eTypes.eBoolean);
            m_top = xDoc.getNodeProperty(nodObj, "Top").getValueInt(eTypes.eLong);
            m_height = xDoc.getNodeProperty(nodObj, "Height").getValueInt(eTypes.eLong);
            m_width = xDoc.getNodeProperty(nodObj, "Width").getValueInt(eTypes.eLong);

            XmlElement nodObjAux = null;
            nodObjAux = nodObj;
            if (!m_objectID.load(xDoc, nodObjAux)) 
            { 
                return false; 
            }
            nodObjAux = nodObj;
            if (!m_info.load(xDoc, nodObjAux)) 
            { 
                return false; 
            }

            return true;
        }

        internal bool save(CSXml.cXml xDoc, XmlElement nodeFather)
        {
            CSXml.cXmlProperty xProperty = null;
            XmlElement nodObj = null;
            xProperty = new CSXml.cXmlProperty();

            xProperty.setName("Field");
            nodObj = xDoc.addNodeToNode(nodeFather, xProperty);

            xProperty.setName("Value");
            xProperty.setValue(eTypes.eText, m_value);
            xDoc.addPropertyToNode(nodObj, xProperty);

            xProperty.setName("Visible");
            xProperty.setValue(eTypes.eBoolean, m_visible);
            xDoc.addPropertyToNode(nodObj, xProperty);

            xProperty.setName("Top");
            xProperty.setValue(eTypes.eLong, m_top);
            xDoc.addPropertyToNode(nodObj, xProperty);

            xProperty.setName("Height");
            xProperty.setValue(eTypes.eLong, m_height);
            xDoc.addPropertyToNode(nodObj, xProperty);

            xProperty.setName("Width");
            xProperty.setValue(eTypes.eLong, m_width);
            xDoc.addPropertyToNode(nodObj, xProperty);

            if (m_objectID != null)
            {
                if (!m_objectID.save(xDoc, nodObj))
                {
                    return false;
                }
            }
            if (!m_info.save(xDoc, nodObj)) 
            { 
                return false; 
            }

            return true;  
        }

        public bool saveForWeb(CSXml.cXml xDoc, XmlElement nodeFather)
        {
            CSXml.cXmlProperty xProperty = null;
            XmlElement nodObj = null;
            xProperty = new CSXml.cXmlProperty();

            xProperty.setName("Field");
            nodObj = xDoc.addNodeToNode(nodeFather, xProperty);

            xProperty.setName("Value");
            xProperty.setValue(eTypes.eText, m_value);
            nodObj = xDoc.addNodeToNode(nodObj, xProperty);
            xDoc.setNodeText(nodObj, m_value);

            return true;
        }

    }

}
